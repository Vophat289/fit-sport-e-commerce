<div class="voucher-page">

  <!-- SIDEBAR: Filters -->
  <aside class="voucher-sidebar">
    <h2 class="sidebar-title">B·ªô l·ªçc Voucher</h2>
    <div class="filter-group">
      <button (click)="applyFilter('all')" [class.active]="activeFilter === 'all'" class="filter-btn">
        <i class="fa fa-th-large"></i> T·∫•t c·∫£
      </button>
      <button (click)="applyFilter('valid')" [class.active]="activeFilter === 'valid'" class="filter-btn">
        <i class="fa fa-check-circle"></i> C√≤n h·∫°n
      </button>
      <button (click)="applyFilter('expiring')" [class.active]="activeFilter === 'expiring'" class="filter-btn">
        <i class="fa fa-clock-o"></i> S·∫Øp h·∫øt h·∫°n
      </button>
    </div>

    <!-- GIFT BOX -->
    <div class="gift-box-container">
      <div class="gift-box">üéÅ</div>
    </div>
  </aside>

  <!-- FIREWORKS -->
  <div class="firework-container left">
    <div class="firework"></div>
    <div class="firework"></div>
    <div class="firework"></div>
  </div>
  <div class="firework-container right">
    <div class="firework"></div>
    <div class="firework"></div>
    <div class="firework"></div>
  </div>

  <!-- MAIN CONTENT: Voucher List -->
  <main class="voucher-main">
    <div class="voucher-header">
      <h1>Kho Voucher C·ª±c L·ªõn</h1>
      <p>SƒÉn ngay voucher gi·∫£m gi√° c·ª±c s·ªëc cho ƒë∆°n h√†ng c·ªßa b·∫°n!</p>
    </div>

    <div class="voucher-grid">
      <div class="voucher-card" *ngFor="let v of filteredVouchers" [class.expired]="isExpired(v)"
        [class.out-of-stock]="isOutOfStock(v)">

        <!-- Left: Icon/Logo -->
        <div class="voucher-left-part">
          <div class="brand-logo">
            <span class="logo-text">SALE</span>
          </div>
        </div>

        <!-- Middle: Info -->
        <div class="voucher-middle-part">
          <div class="voucher-header-info">
            <span class="voucher-code">{{ v.code }}</span>
            <span class="voucher-tag" *ngIf="v.type === 'percent'">Gi·∫£m {{ v.value }}%</span>
            <span class="voucher-tag" *ngIf="v.type === 'fixed'">Gi·∫£m {{ v.value | currency:'VND' }}</span>
          </div>

          <p class="voucher-desc">ƒê∆°n t·ªëi thi·ªÉu: {{ v.min_order_value | currency:'VND' }}</p>

          <div class="voucher-progress">
            <div class="progress-bar">
              <div class="progress-fill" [style.width.%]="(getRemaining(v) / v.usage_limit) * 100"></div>
            </div>
            <span class="progress-text">C√≤n l·∫°i: {{ getRemaining(v) }}</span>
          </div>

          <div class="voucher-expiry">
            HSD: {{ v.end_date | date:'dd/MM/yyyy' }}
          </div>
        </div>

        <!-- Right: Action -->
        <div class="voucher-right-part">
          <button class="action-btn" [class.collected]="isCollected(v.code)"
            [disabled]="isExpired(v) || isCollected(v.code) || isOutOfStock(v)" (click)="collectVoucher(v)">
            {{ isExpired(v) ? 'H·∫øt h·∫°n' : (isCollected(v.code) ? 'ƒê√£ thu th·∫≠p' : (isOutOfStock(v) ? 'ƒê√£ h·∫øt voucher' :
            'Thu th·∫≠p')) }}
          </button>
          <button class="detail-link" (click)="copyCode(v.code)" *ngIf="!isExpired(v)">Sao ch√©p m√£</button>
        </div>

      </div>
    </div>

    <div class="load-more" *ngIf="hasMore">
      <button (click)="loadMore()" [disabled]="loading" class="load-more-btn">
        {{ loading ? 'ƒêang t·∫£i...' : 'Xem th√™m Voucher' }}
      </button>
    </div>
  </main>

</div>