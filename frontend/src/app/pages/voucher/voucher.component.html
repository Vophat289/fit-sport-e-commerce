<div class="voucher-page">

  <!-- SIDEBAR: Filters -->
  <aside class="voucher-sidebar">
    <h2 class="sidebar-title">Bá»™ lá»c Voucher</h2>
    <div class="filter-group">
      <button (click)="applyFilter('all')" [class.active]="activeFilter === 'all'" class="filter-btn">
        <i class="fa fa-th-large"></i> Táº¥t cáº£
      </button>
      <button (click)="applyFilter('valid')" [class.active]="activeFilter === 'valid'" class="filter-btn">
        <i class="fa fa-check-circle"></i> CÃ²n háº¡n
      </button>
      <button (click)="applyFilter('expiring')" [class.active]="activeFilter === 'expiring'" class="filter-btn">
        <i class="fa fa-clock-o"></i> Sáº¯p háº¿t háº¡n
      </button>
    </div>

    <!-- GIFT BOX -->
    <div class="gift-box-container">
      <div class="gift-box">ğŸ</div>
    </div>
  </aside>

  <!-- Celebration overlay -->
  <div class="celebration-strip">
    <div class="celebration-confetti"></div>
    <div class="celebration-confetti"></div>
    <div class="celebration-confetti"></div>
    <div class="celebration-confetti"></div>
    <div class="celebration-confetti"></div>
    <div class="celebration-confetti"></div>
    <div class="celebration-confetti"></div>
  </div>

  <!-- MAIN CONTENT: Voucher List -->
  <main class="voucher-main">
    <div class="voucher-header">
      <div class="voucher-header-top">
        <h1>SÄƒn Voucher Má»«ng Viá»‡t Nam VÃ´ Äá»‹ch SEA Games 33</h1>
        <span class="vn-badge">ğŸ‡»ğŸ‡³ Æ¯u Ä‘Ã£i vÃ ng cho fan Viá»‡t Nam ğŸ‡»ğŸ‡³</span>
      </div>
      <p class="voucher-header-subtitle">
        SÄƒn tháº­t nhanh cÃ¡c voucher giá»›i háº¡n má»«ng chiáº¿n tháº¯ng lá»‹ch sá»­, Ã¡p dá»¥ng cho toÃ n bá»™ Ä‘Æ¡n hÃ ng thá»ƒ thao!
      </p>
    </div>

    <div class="voucher-grid">
      <div class="voucher-card" *ngFor="let v of filteredVouchers" [class.expired]="isExpired(v)"
        [class.out-of-stock]="isOutOfStock(v)">

        <!-- Left: Icon/Logo -->
        <div class="voucher-left-part">
          <div class="brand-logo">
            <span class="logo-text">SALE</span>
          </div>
        </div>

        <!-- Middle: Info -->
        <div class="voucher-middle-part">
          <div class="voucher-header-info">
            <span class="voucher-code">{{ v.code }}</span>
            <span class="voucher-tag" *ngIf="v.type === 'percent'">Giáº£m {{ v.value }}%</span>
            <span class="voucher-tag" *ngIf="v.type === 'fixed'">Giáº£m {{ v.value | currency:'VND' }}</span>
          </div>

          <p class="voucher-desc">ÄÆ¡n tá»‘i thiá»ƒu: {{ v.min_order_value | currency:'VND' }}</p>

          <div class="voucher-progress">
            <div class="progress-bar">
              <div class="progress-fill" [style.width.%]="(getRemaining(v) / v.usage_limit) * 100"></div>
            </div>
            <span class="progress-text">CÃ²n láº¡i: {{ getRemaining(v) }}</span>
          </div>

          <div class="voucher-expiry" *ngIf="!isComingSoon(v)">
            HSD: {{ v.end_date | date:'dd/MM/yyyy' }}
          </div>
          <div class="voucher-countdown" *ngIf="isComingSoon(v)">
            <i class="fa fa-hourglass-start"></i> Báº¯t Ä‘áº§u sau: <span>{{ countdownTimers[v.code] }}</span>
          </div>
        </div>

        <!-- Right: Action -->
        <div class="voucher-right-part">
          <button class="action-btn" [class.collected]="isCollected(v)" [class.coming-soon]="isComingSoon(v)"
            [disabled]="isExpired(v) || isCollected(v) || isOutOfStock(v) || isComingSoon(v)"
            (click)="collectVoucher(v)">
            {{ isComingSoon(v) ? 'Sáº¯p diá»…n ra' : (isExpired(v) ? 'Háº¿t háº¡n' : (isCollected(v) ? 'ÄÃ£ thu tháº­p' :
            (isOutOfStock(v) ? 'ÄÃ£ háº¿t voucher' : 'Thu tháº­p'))) }}
          </button>
          <button class="detail-link" (click)="copyCode(v.code)" *ngIf="!isExpired(v) && !isComingSoon(v)">Sao chÃ©p
            mÃ£</button>
        </div>

      </div>
    </div>

    <div class="load-more" *ngIf="hasMore">
      <button (click)="loadMore()" [disabled]="loading" class="load-more-btn">
        {{ loading ? 'Äang táº£i...' : 'Xem thÃªm Voucher' }}
      </button>
    </div>
  </main>

</div>