<!-- news.component.html -->
<div class="news-container">
  <div class="news-layout">

    <!-- ===== LEFT: LIST + FILTER ===== -->
    <div class="news-left">

      <!-- ========== MAIN LIST ========== -->
      <main class="news-main">

        <!-- Hero -->
        <div class="news-hero">
          <div class="hero-left">
            <h1 class="page-title">B√†i vi·∫øt m·ªõi nh·∫•t</h1>
            <p class="page-subtitle">
              C·∫≠p nh·∫≠t ki·∫øn th·ª©c t·∫≠p luy·ªán, dinh d∆∞·ª°ng v√† xu h∆∞·ªõng th·ªÉ thao n√≥ng h·ªïi!
            </p>
          </div>
        </div>

        <!-- Grid b√†i vi·∫øt -->
        <div class="news-grid" *ngIf="paginatedNews.length > 0">
          <article class="news-card" *ngFor="let item of paginatedNews">

            <!-- üî¥ routerLink RELATIVE -->
            <a [routerLink]="[item.slug]" class="thumb-link">
              <div class="img-box">
                <img
                  [src]="item.thumbnail"
                  [alt]="item.title"
                  loading="lazy"
                  (error)="handleImageError($event)"
                />

                <!-- overlay n√∫t gi·ªØa ·∫£nh -->
                <div class="img-overlay">
                  <span class="view-more-btn">Xem th√™m</span>
                </div>
              </div>
            </a>

            <div class="content-box">
              <h2 class="news-title">
                <a [routerLink]="[item.slug]" [title]="item.title">
                  {{ item.title }}
                </a>
              </h2>

              <p class="news-desc" *ngIf="item.short_desc">
                {{ item.short_desc }}
              </p>

              <div class="news-meta">
                <span class="date">{{ item.createdAt | date:'dd/MM/yyyy' }}</span>

                <div class="tags" *ngIf="item.tags && item.tags.length > 0">
                  <button
                    class="tag-pill"
                    type="button"
                    *ngFor="let tg of item.tags | slice:0:2"
                    (click)="selectTag(tg)">
                    #{{ tg }}
                  </button>
                </div>
              </div>
            </div>

          </article>
        </div>

        <!-- Empty khi filter kh√¥ng ra -->
        <div class="empty-state" *ngIf="news.length > 0 && paginatedNews.length === 0">
          <p>Kh√¥ng t√¨m th·∫•y b√†i vi·∫øt ph√π h·ª£p v·ªõi tag n√†y.</p>
          <button class="empty-btn" (click)="clearTagFilter()">X√≥a b·ªô l·ªçc</button>
        </div>

        <!-- Pagination -->
        <div class="pagination-wrapper" *ngIf="totalPages > 1">
          <button
            class="pagination-btn prev"
            (click)="changePage(currentPage - 1)"
            [disabled]="currentPage === 1">
            ‚Üê Tr∆∞·ªõc
          </button>

          <span class="pagination-info">
            Trang <strong>{{ currentPage }}</strong> / {{ totalPages }}
          </span>

          <button
            class="pagination-btn next"
            (click)="changePage(currentPage + 1)"
            [disabled]="currentPage === totalPages">
            Sau ‚Üí
          </button>
        </div>

        <div class="empty-state" *ngIf="news.length === 0">
          <p>Ch∆∞a c√≥ tin t·ª©c n√†o. H√£y quay l·∫°i sau nh√©!</p>
        </div>

      </main>

      <!-- ========== FILTER TAG ========== -->
      <aside class="news-aside">
        <div class="aside-card">
          <h3 class="aside-title">L·ªçc theo tag</h3>

          <div class="tag-search">
            <span class="hash">#</span>
            <input
              type="text"
              [(ngModel)]="tagQuery"
              (input)="onTagInput()"
              placeholder="T√¨m theo tag... (vd: #yoga, #dinhduong)"
            />
            <button class="btn-clear" *ngIf="tagQuery" (click)="clearTagFilter()">‚úï</button>
          </div>

          <div class="tag-chips" *ngIf="getAvailableTags().length">
            <button
              class="chip"
              *ngFor="let t of getAvailableTags()"
              [class.active]="normalizeTag(t) === normalizeTag(selectedTag || tagQuery)"
              (click)="selectTag(t)">
              #{{ t }}
            </button>
          </div>

          <button class="aside-clear" *ngIf="tagQuery || selectedTag" (click)="clearTagFilter()">
            B·ªè l·ªçc
          </button>
        </div>
      </aside>

    </div>

    <!-- ===== RIGHT: DETAIL ===== -->
    <aside class="news-detail-pane">
      <router-outlet></router-outlet>

      <div class="detail-empty" *ngIf="!hasSelectedArticle">
        <p>üëà Ch·ªçn m·ªôt b√†i vi·∫øt ƒë·ªÉ xem chi ti·∫øt</p>
      </div>
    </aside>

  </div>
</div>
