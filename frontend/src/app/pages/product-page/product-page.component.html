<section class="product-section">
  <div class="product-container">
   

    <!-- üîπ SIDEBAR FILTER (B√™n tr√°i) -->
    <aside class="filter-sidebar">
      
      <!-- Header Sidebar -->
      <div class="filter-header">
        <h2 class="filter-header-title">
          <i class="fa-solid fa-filter"></i>
          B·ªô l·ªçc
        </h2>
        <button class="btn-reset" (click)="resetFilters()">
          <i class="fa-solid fa-rotate-left"></i>
          X√≥a b·ªô l·ªçc
        </button>
      </div>
      
      <!-- 1. FILTER CATEGORY -->
      <div class="filter-group">
        <h3 class="filter-title">
          <i class="fa-solid fa-tags"></i>
          Danh m·ª•c
        </h3>
        <div class="filter-buttons">
          <button 
            (click)="filterByCategory(null)"
            [class.active]="!filters.category"
            class="filter-btn">
            <i class="fa-solid fa-th"></i>
            T·∫•t c·∫£
          </button>
          <button
            *ngFor="let cat of categories"
            (click)="filterByCategory(cat.slug!)"
            [class.active]="filters.category === cat.slug"
            class="filter-btn">
            {{ cat.name }}
          </button>
        </div>
      </div>
      
      <!-- 2. FILTER SIZE -->
      <div class="filter-group">
        <h3 class="filter-title">
          <i class="fa-solid fa-ruler"></i>
          K√≠ch th∆∞·ªõc
        </h3>
        <div class="size-options">
          <label 
            *ngFor="let size of availableSizes"
            class="size-checkbox"
            [class.checked]="filters.sizes.includes(size)">
            <input 
              type="checkbox"
              [checked]="filters.sizes.includes(size)"
              (change)="toggleSize(size)">
            <span class="checkbox-custom"></span>
            <span class="size-label">{{ size }}</span>
          </label>
        </div>
      </div>
      
          <!-- 3. FILTER PRICE (Slider) -->
          <div class="filter-group">
           <h3 class="filter-title">
             <i class="fa-solid fa-dollar-sign"></i>
             CH·ªåN GI√Å
           </h3>
           <div class="price-slider">
             <!-- Input Min -->
             <div class="price-input-group">
               <label class="price-label">T·ª´</label>
               <input 
                 type="number"
                 [(ngModel)]="filters.priceRange.min"
                 (ngModelChange)="updatePriceRange(filters.priceRange.min, filters.priceRange.max)"
                 class="price-input"
                 [min]="20000"
                 [max]="5000000">
               <span class="price-unit">‚Ç´</span>
             </div>
             
             <!-- Slider Container - 1 THANH C√ì 2 C·ª§C (MIN & MAX) -->
             <div class="slider-container">
               <input 
                 type="range"
                 [min]="20000"
                 [max]="5000000"
                 [(ngModel)]="filters.priceRange.min"
                 (input)="updatePriceRange(filters.priceRange.min, filters.priceRange.max)"
                 class="slider slider-min">
               
               <input 
                 type="range"
                 [min]="20000"
                 [max]="5000000"
                 [(ngModel)]="filters.priceRange.max"
                 (input)="updatePriceRange(filters.priceRange.min, filters.priceRange.max)"
                 class="slider slider-max">
             </div>
             
             <!-- Input Max -->
             <div class="price-input-group">
               <label class="price-label">ƒê·∫øn</label>
               <input 
                 type="number"
                 [(ngModel)]="filters.priceRange.max"
                 (ngModelChange)="updatePriceRange(filters.priceRange.min, filters.priceRange.max)"
                 class="price-input"
                 [min]="20000"
                 [max]="5000000">
               <span class="price-unit">‚Ç´</span>
             </div>
           </div>
           
           <!-- Hi·ªÉn th·ªã gi√° ƒë√£ ch·ªçn -->
           <div class="price-display">
             <span class="price-display-label">Kho·∫£ng gi√°:</span>
             <span class="price-display-value">
               {{ filters.priceRange.min | number }} ‚Ç´ - 
               {{ filters.priceRange.max | number }} ‚Ç´
             </span>
           </div>
         </div>
      
    </aside>
    
    <!-- üîπ PRODUCT CONTENT (B√™n ph·∫£i) -->
    <div class="product-content">
      
      <nav class="breadcrumb">
        <a routerLink="/home">Trang ch·ªß</a>
        <span>/</span>
        <a routerLink="/products">S·∫£n ph·∫©m</a>
      </nav>
      <!-- Header Product List -->
      <div class="product-header">
        <h2 class="product-header-title">
          S·∫£n ph·∫©m
          <span class="product-count" *ngIf="!loading">
            ({{ filteredProducts.length }} s·∫£n ph·∫©m)
          </span>
        </h2>
      </div>
      
      <!-- Loading -->
      <div *ngIf="loading" class="loading-container">
        <div class="loading-spinner"></div>
        <p class="loading-text">ƒêang t·∫£i s·∫£n ph·∫©m...</p>
      </div>
      
      <!-- Danh s√°ch s·∫£n ph·∫©m -->
      <div class="product-list" *ngIf="!loading && filteredProducts.length > 0">
        <div class="product-card" *ngFor="let product of filteredProducts">
          <!-- ·∫¢nh -->
          <div class="product-image">
            <img
              [src]="
                product.image && product.image.length
                  ? product.image[0]
                  : 'assets/images/placeholder.jpg'
              "
              [alt]="product.name"
              class="product-img"
            />
            <div class="product-overlay">
              <button class="btn-detail">
                <i class="fa-solid fa-eye"></i>
                <a [routerLink]="['/products', product.slug]">
                  Xem chi ti·∫øt
                </a>
              </button>
              <button class="btn-buy">
                <i class="fa-solid fa-cart-shopping"></i>
                Mua ngay
              </button>
            </div>
          </div>
          
          <!-- Th√¥ng tin -->
          <div class="product-info">
            <h3 class="product-name">{{ product.name }}</h3>
            <p class="product-price">{{ product.price | number }} ‚Ç´</p>

            <!-- M√†u s·∫Øc -->
            <div *ngIf="(product?.colors?.length ?? 0) > 0" class="product-colors">
              <span 
                *ngFor="let c of product.colors"
                class="color-dot"
                [style.backgroundColor]="c"
                [title]="c">
              </span>
            </div>

            <!-- K√≠ch th∆∞·ªõc -->
            <div *ngIf="(product?.sizes?.length ?? 0) > 0" class="product-sizes">
              <span 
                *ngFor="let s of product.sizes" 
                class="size-tag">
                {{ s }}
              </span>
            </div>
          </div>
          
          <!-- N√∫t th√™m gi·ªè -->
          <div class="product-action">
            <button class="btn-cart" (click)="addToCart(product)">
              <i class="fa-solid fa-cart-plus"></i>
              Th√™m v√†o gi·ªè h√†ng
            </button>
          </div>
        </div>
      </div>
      
      <!-- Empty State -->
      <div *ngIf="!loading && filteredProducts.length === 0" class="empty-container">
        <i class="fa-solid fa-box-open empty-icon"></i>
        <p class="empty-text">Kh√¥ng c√≥ s·∫£n ph·∫©m n√†o ph√π h·ª£p v·ªõi b·ªô l·ªçc.</p>
        <button class="btn-empty-reset" (click)="resetFilters()">
          X√≥a b·ªô l·ªçc
        </button>
      </div>
      
    </div>
    
  </div>
</section>