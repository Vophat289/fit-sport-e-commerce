
<div class="favorites-page">
  <h2>Danh sách sản phẩm yêu thích</h2>

  <div *ngIf="loading" class="loading">
    Đang tải sản phẩm yêu thích...
  </div>

  <div *ngIf="!loading && favorites.length === 0" class="no-favorites">
    <p>Bạn chưa có sản phẩm yêu thích nào.</p>
  </div>

  <div *ngIf="!loading && favorites.length > 0" class="favorites-list">
    <div *ngFor="let product of favorites" class="favorite-item">

      <img 
        [src]="product.image?.[0] || 'assets/images/placeholder.jpg'"
        [alt]="product.name"
        (click)="goToProduct(product.slug)"
      >

      <div class="info">
        <h4 (click)="goToProduct(product.slug)">{{ product.name }}</h4>
        <p>{{ ((product.displayPrice ?? product.price) | number) }}₫</p>
        <div class="product-meta">
          <div class="product-views">
            <i class="fa fa-eye"></i> {{ product.viewCount || 0 }} lượt xem
          </div>

          <button class="favorite-btn" 
                  [class.active]="isFavorite(product)" 
                  (click)="toggleFavorite(product)">
            <i class="fa fa-heart"></i>
          </button>
        </div>
      </div>

      <!-- Nút thêm vào giỏ hàng -->
      <div class="product-action">
        <button class="btn-cart" (click)="openVariantModal(product)">
          <i class="fa-solid fa-cart-plus"></i> Thêm vào giỏ hàng
        </button>
      </div>
    </div>
  </div>

  <!-- Modal chọn variant -->
  <app-product-modal 
    [isModalOpen]="isModalOpen" 
    [selectedProduct]="selectedProduct" 
    (closeModal)="closeModal()"
    (confirmAddToCart)="handleAddToCart($event)">
  </app-product-modal>
</div>